<div [ngClass]="layoutConfiguration ? 'sbt-fluid-content-bg':''">
  <div [ngClass]="layoutConfiguration ? 'sb-g sbt-container sbt-page-content' : 'sb-g'">
    <div [ngClass]="FIRST_PANEL_LAYOUT">
      <div *ngIf="layoutConfiguration">
        <ng-container *ngIf="isDesktopApp">
          <app-network-status></app-network-status>
          <app-load-offline-content></app-load-offline-content>
          <app-system-warning></app-system-warning>
        </ng-container>
      </div>
      <div [ngClass]="isDesktopApp ? 'sb-desktop-filter-section' : ''">
        <ng-container class="h-100">
          <div class="filters-area h-100">
            <p class="header font-weight-bold mb-8">Recent Queries</p>
            <ul *ngIf="searchQueryList.length>0">
              <li *ngFor="let search of searchQueryList">
                <a href="{{search?.id}}">{{search?.searchQuery}}</a>
              </li>
            </ul>
          </div>
        </ng-container>
      </div>
    </div>
    <div [ngClass]="SECOND_PANEL_LAYOUT" class="w-100">
      <div [ngClass]="layoutConfiguration ? 'sbt-page-content-area' : 'ui container mt-24'">
        <div class="content-grid relative9">
          <div [appTelemetryImpression]="telemetryImpression" class="twelve wide column content-scroll"
            in-view-container>
            <div class="chatgpt-box h-100">
              <!-- Chats container -->
              <!-- <div class="chat-container" #chatData id="chat-data"> -->
              <div #chatData id="chat-data">
                <ng-container *ngIf="apiData.length>0">
                  <ng-container *ngFor="let data of apiData;">
                    <div class="ai-question" *ngIf="data?.question">
                      <div class="ai-question-img"><img alt="logo image"
                          src="../../../../../../assets/images/profile-icon.svg">
                      </div>
                      <div class="ai-question-text">{{data?.question}}</div>
                    </div>

                    <div class="ai-answer" *ngIf="data?.answer">
                      <div class="ai-answer-section">
                        <div class="ai-answer-img"><img alt="logo image" src="../../../../../../assets/images/logo.png">
                        </div>
                        <div class="ai-answer-text">{{data?.answer}}</div>
                      </div>
                      <ng-container>
                        <div class="ai-data-accordion">
                          <mat-accordion>
                            <mat-expansion-panel>
                              <mat-expansion-panel-header>
                                <mat-panel-title class="sb-mat-accordion__title">
                                  References
                                </mat-panel-title>
                              </mat-expansion-panel-header>

                              <div class="mat-expansion-panel-content" role="reference"
                                aria-labelledby="mat-expansion-panel-header-4">
                                <div class="mat-expansion-panel-body">
                                  <div class="sb-mat-accordion__content"
                                    *ngFor="let reference of data?.reference; let i = index">
                                    <h5>Reference {{i+1}}</h5>
                                    <ul>
                                      <li><span>Class:</span>{{reference?.metadata?.class}}</li>
                                      <li><span>Book Name:</span>{{reference?.metadata?.book_name}}</li>
                                      <li><span>Chapter Name:</span>{{reference?.metadata?.chapter_name}}</li>
                                      <li><span>Page Number:</span>{{reference?.metadata?.page}}</li>
                                    </ul>
                                  </div>
                                </div>
                              </div>

                            </mat-expansion-panel>
                          </mat-accordion>
                        </div>
                      </ng-container>

                    </div>

                  </ng-container>
                </ng-container>

                <ng-container *ngIf="apiData.length <= 0">
                  <div class="default-content">
                    <h2>Diksha: Chat with books</h2>
                  </div>
                </ng-container>


              </div>
              <!-- Typing container -->
              
            </div>
          </div>
          <div class="typing-container">
            <div class="typing-content">
              <div class="typing-textarea">
                <textarea id="chat-input" spellcheck="false" placeholder="Enter a prompt here" required
                  [(ngModel)]="searchQuery" (keyup.enter)="saveBooksQuery()"></textarea>
                <span (click)="saveBooksQuery()" id="send-btn" class="material-symbols-rounded"><i
                    class="fa fa-arrow-right"></i></span>
              </div>
              <!-- <div class="typing-controls">
                <span id="delete-btn" class="material-symbols-rounded"><i class="fa fa-trash-alt"></i></span>
              </div> -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>